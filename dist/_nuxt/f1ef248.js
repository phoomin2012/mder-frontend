(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{371:function(t,e,o){"use strict";o.d(e,"a",(function(){return d}));var r=o(368),n=o(367);function d(t,e){Object(n.a)(2,arguments);var o=Object(r.a)(t),d=Object(r.a)(e);return o.getTime()-d.getTime()}},373:function(t,e,o){"use strict";o.d(e,"a",(function(){return d}));var r=o(368),n=o(367);function d(t){Object(n.a)(1,arguments);var e=Object(r.a)(t);return e.setHours(0,0,0,0),e}},381:function(t,e,o){var content=o(418);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(73).default)("22539c68",content,!0,{sourceMap:!1})},389:function(t,e,o){"use strict";o.d(e,"a",(function(){return m}));var r=o(375),n=o(373),d=o(367),c=864e5;function m(t,e){Object(d.a)(2,arguments);var o=Object(n.a)(t),m=Object(n.a)(e),l=o.getTime()-Object(r.a)(o),h=m.getTime()-Object(r.a)(m);return Math.round((l-h)/c)}},409:function(t,e,o){"use strict";o.d(e,"a",(function(){return d}));var r=o(371),n=o(367);function d(t,e){Object(n.a)(2,arguments);var o=Object(r.a)(t,e)/6e4;return o>0?Math.floor(o):Math.ceil(o)}},417:function(t,e,o){"use strict";o(381)},418:function(t,e,o){var r=o(72)(!1);r.push([t.i,".popover-period{max-width:unset}.popover-period .popover-body{padding:0}.popover-period .custom-period{padding:.5rem .75rem}.popover-period .past-period{padding:.5rem 0}.select-time{width:140px!important;height:auto}.select-time .custom-select{height:100%!important}.past-period .menu{text-align:left;list-style:none;margin:.125rem 0 0;padding:0}.past-period .menu .period-item{display:block;width:100%;padding:.25rem 1.5rem;clear:both;font-weight:400;color:#212529;text-align:inherit;white-space:nowrap;background-color:transparent;border:0}.past-period .menu .period-item:focus,.past-period .menu .period-item:hover{color:#16181b;text-decoration:none;background-color:#f8f9fa}.date-output{margin-bottom:.25rem;padding:.25rem;font-size:80%}",""]),t.exports=r},473:function(t,e,o){"use strict";o.r(e);o(37);var r=o(389),n=o(409),d=o(575),c={name:"PeriodButton",props:{mode:{type:String,default:"past"},past:{type:Object,default:function(){return{unit:"hour",amount:1,value:"-1h"}}},start:{type:Date,default:null},end:{type:Date,default:null}},data:function(){return{refreshRate:null,showMode:this.mode,modePeriod:this.mode,pastPeriod:this.past||{unit:"hour",amount:1,value:"-1h"},startDate:null,startTime:{hour:0,minute:0},endDate:null,endTime:{hour:0,minute:0},timer:null}},computed:{timesOptions:function(){for(var t=[],i=0;i<24;i++)for(var e=0;e<6;e++)t.push({hour:i,minute:10*e}),t.push({hour:i,minute:10*e+5});return t},startDateTime:function(){var t=new Date(this.startDate);return t.setHours(this.startTime.hour),t.setMinutes(this.startTime.minute),t},endDateTime:function(){var t=new Date(this.endDate);return t.setHours(this.endTime.hour),t.setMinutes(this.endTime.minute),t},pastPeriodOptions:function(){for(var t=[],e=0,o=[5,15,30];e<o.length;e++){var i=o[e];t.push({unit:"minute",amount:i,value:"-".concat(i,"m")})}for(var r=0,n=[1,3,6,12,24];r<n.length;r++){var d=n[r];t.push({unit:"hour",amount:d,value:"-".concat(d,"h")})}for(var c=0,m=[2,7,30];c<m.length;c++){var l=m[c];t.push({unit:"day",amount:l,value:"-".concat(l,"d")})}return t}},created:function(){this.loadPeriodFromStorage(),this.$emit("loaded"),this.startRefreshTask()},beforeDestroy:function(){this.timer&&clearInterval(this.timer)},methods:{dateClass:function(t,e){if(this.startDate&&this.endDate){var o=new Date(this.startDate),n=new Date(this.endDate);if(Object(r.a)(e,o)>=0&&Object(r.a)(n,e)>=0)return"table-primary"}return""},timeDisable:function(t,e,o,r){var d=new Date(t);d.setHours(o.hour),d.setMinutes(o.minute);var c=new Date(e);return c.setHours(r.hour),c.setMinutes(r.minute),Object(n.a)(d,c)},formatDateTime:function(t){return Object(d.a)(t,"yyyy/MM/dd HH:mm")},loadPeriodFromStorage:function(){var t=window.localStorage.getItem("history-report-period");if(t){var data=JSON.parse(t);void 0===data.mode?(this.modePeriod=this.mode,this.showMode=this.mode):(this.modePeriod=data.mode,this.showMode=data.mode),this.refreshRate=data.refreshRate||null,this.pastPeriod=data.pastPeriod,this.startDate=data.startDate,this.startTime=data.startTime,this.endDate=data.endDate,this.endTime=data.endTime,this.$emit("update:mode",this.modePeriod),this.$emit("update:past",this.pastPeriod),this.$emit("update:start",this.startDateTime),this.$emit("update:end",this.endDateTime)}},savePeriodToStorage:function(){window.localStorage.setItem("history-report-period",JSON.stringify({mode:this.modePeriod,refreshRate:this.refreshRate,pastPeriod:this.pastPeriod,startDate:this.startDate,startTime:this.startTime,endDate:this.endDate,endTime:this.endTime}))},showPopover:function(){this.$root.$emit("bv::show::popover","popover-choose-period")},closePopover:function(){this.$root.$emit("bv::hide::popover","popover-choose-period")},choosePast:function(t){this.modePeriod="past",this.pastPeriod=t,this.savePeriodToStorage(),this.startRefreshTask(),this.$emit("update:mode","past"),this.$emit("update:past",this.pastPeriod),this.$emit("change",{mode:"past",start:t})},submitCustom:function(){this.modePeriod="custom",this.savePeriodToStorage(),this.startRefreshTask(),this.$emit("update:mode","custom"),this.$emit("update:start",this.startDateTime),this.$emit("update:end",this.endDateTime),this.$emit("change",{mode:"custom",start:this.startDateTime,end:this.endDateTime}),this.closePopover()},startRefreshTask:function(){var t=this;this.timer&&(clearInterval(this.timer),this.timer=null),null!==this.refreshRate&&(this.timer=setInterval((function(){t.$emit("fetch")}),1e3*this.refreshRate))},changeRefreshRate:function(t){this.refreshRate=t,this.savePeriodToStorage(),this.startRefreshTask()}}},m=(o(417),o(51)),component=Object(m.a)(c,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[null===t.refreshRate?o("b-button",{on:{click:function(e){return t.$emit("fetch")}}},[o("fa-icon",{attrs:{icon:"sync"}})],1):t._e(),t._v(" "),o("b-dropdown",{scopedSlots:t._u([{key:"button-content",fn:function(){return[null===t.refreshRate?o("span",[o("fa-icon",{attrs:{icon:"pause"}}),t._v("\n        "+t._s(t.$t("history.refresh.pause"))+"\n      ")],1):o("span",[o("fa-icon",{attrs:{icon:"sync"}}),t._v("\n        "+t._s(t.$tc("history.refresh.second",t.refreshRate))+"\n      ")],1)]},proxy:!0}])},[t._v(" "),o("b-dropdown-header",[t._v("\n      "+t._s(t.$t("history.refresh.title"))+"\n    ")]),t._v(" "),t._l([null,5,10,15,30,60],(function(e,i){return o("b-dropdown-item-button",{key:i,on:{click:function(o){return t.changeRefreshRate(e)}}},[t._v("\n      "+t._s(null===e?t.$t("history.refresh.pause"):t.$tc("history.refresh.second",e))+"\n    ")])}))],2),t._v(" "),o("b-button",{attrs:{id:"button-choose-period",variant:"outline-secondary"},on:{click:t.showPopover}},[o("fa-icon",{attrs:{icon:"clock"}}),t._v(" "),"past"===t.modePeriod?o("span",[t._v("\n      "+t._s(t.$tc("history.past."+t.pastPeriod.unit,t.pastPeriod.amount))+"\n    ")]):"custom"===t.modePeriod?o("span",[t._v("\n      "+t._s(t.formatDateTime(t.startDateTime))+" - "+t._s(t.formatDateTime(t.endDateTime))+"\n    ")]):o("span",[t._v("\n      "+t._s(t.$t("history.choosePeriod"))+"\n    ")])],1),t._v(" "),o("b-popover",{attrs:{id:"popover-choose-period",target:"button-choose-period",placement:"bottom",triggers:"click","custom-class":"popover-period"}},["custom"===t.showMode?o("div",{staticClass:"custom-period"},[o("div",{staticClass:"d-flex"},[o("div",{attrs:{label:"Start"}},[o("div",{staticClass:"mt-1 mb-2"},[t._v("\n            "+t._s(t.$t("history.start"))+"\n          ")]),t._v(" "),o("div",{staticClass:"d-flex"},[o("div",[o("div",{staticClass:"date-output form-control form-control-sm text-center"},[t._v("\n                "+t._s(t.formatDateTime(t.startDateTime))+"\n              ")]),t._v(" "),o("b-calendar",{attrs:{locale:t.$i18n.locale,"date-info-fn":t.dateClass,max:t.endDate,"hide-header":""},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1),t._v(" "),o("div",{staticClass:"select-time ml-2"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.startTime,expression:"startTime"}],staticClass:"custom-select",attrs:{size:"4"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.startTime=e.target.multiple?o:o[0]}}},t._l(t.timesOptions,(function(time,i){return o("option",{key:i,attrs:{disabled:t.timeDisable(t.endDate,t.startDate,t.endTime,time)<=0},domProps:{value:time}},[t._v("\n                  "+t._s(10>time.hour?"0"+time.hour:time.hour)+":"+t._s(10>time.minute?"0"+time.minute:time.minute)+"\n                ")])})),0)])])]),t._v(" "),o("div",{staticClass:"ml-2 border-left pl-2"},[o("div",{staticClass:"mt-1 mb-2"},[t._v("\n            "+t._s(t.$t("history.end"))+"\n          ")]),t._v(" "),o("div",{staticClass:"d-flex"},[o("div",[o("div",{staticClass:"date-output form-control form-control-sm text-center"},[t._v("\n                "+t._s(t.formatDateTime(t.endDateTime))+"\n              ")]),t._v(" "),o("b-calendar",{attrs:{locale:t.$i18n.locale,"date-info-fn":t.dateClass,min:t.startDate,"hide-header":""},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1),t._v(" "),o("div",{staticClass:"select-time ml-2"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.endTime,expression:"endTime"}],staticClass:"custom-select",attrs:{size:"4"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.endTime=e.target.multiple?o:o[0]}}},t._l(t.timesOptions,(function(time,i){return o("option",{key:i,attrs:{disabled:t.timeDisable(t.endDate,t.startDate,time,t.startTime)<=0},domProps:{value:time}},[t._v("\n                  "+t._s(10>time.hour?"0"+time.hour:time.hour)+":"+t._s(10>time.minute?"0"+time.minute:time.minute)+"\n                ")])})),0)])])])]),t._v(" "),o("div",{staticClass:"d-flex justify-content-between mt-2"},[o("div",{staticClass:"text-left"},[o("b-button",{attrs:{variant:"outline-success"},on:{click:function(e){t.showMode="past"}}},[t._v("\n            "+t._s(t.$t("history.pastPeriod"))+"\n          ")])],1),t._v(" "),o("div",{staticClass:"text-right"},[o("b-button",{attrs:{variant:"outline-secondary"},on:{click:t.closePopover}},[t._v("\n            "+t._s(t.$t("history.cancel"))+"\n          ")]),t._v(" "),o("b-button",{attrs:{variant:"primary"},on:{click:t.submitCustom}},[t._v("\n            "+t._s(t.$t("history.submit"))+"\n          ")])],1)])]):o("div",{staticClass:"past-period"},[o("ul",{staticClass:"menu"},[o("li",[o("button",{staticClass:"period-item",on:{click:function(e){t.showMode="custom"}}},[o("fa-icon",{attrs:{icon:"calendar"}}),t._v("\n            "+t._s(t.$t("history.customPeriod"))+"\n          ")],1)]),t._v(" "),t._l(t.pastPeriodOptions,(function(e,i){return o("li",{key:i,class:[{active:e.value===t.pastPeriod.value}]},[o("button",{staticClass:"period-item",on:{click:function(o){return t.choosePast(e)}}},[t._v("\n            "+t._s(t.$tc("history.past."+e.unit,e.amount))+"\n          ")])])}))],2)])])],1)}),[],!1,null,null,null);e.default=component.exports}}]);