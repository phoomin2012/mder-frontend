(window.webpackJsonp=window.webpackJsonp||[]).push([[19,11],{372:function(e,t,r){"use strict";r.r(t);r(71),r(10),r(31),r(21),r(1),r(3),r(52);var n={name:"ErrorHandle",props:{errors:{type:Array,default:function(){return[]}},prefix:{type:String,default:null},name:{type:String,default:""},noValid:{type:Boolean,default:!1}},computed:{_errors:function(){return Array.isArray(this.errors)?this.errors:"string"==typeof this.errors?[this.errors]:[]},state:function(){if(0===this._errors.length)return null;var e=new RegExp("^".concat(this.name,"\\.")),t=!this._errors.filter((function(t){return e.test(t)})).length>0;return t&&this.noValid?null:t},description:function(){if(0===this._errors.length)return null;var e=new RegExp("^".concat(this.name,"\\.")),t=this._errors.filter((function(t){return e.test(t)}));return t.length>0?this.$t("error.form."+(this.prefix?this.prefix+".":"")+t[0]):null}},render:function(){return this.$scopedSlots.default({state:this.state,invalidFeedback:this.description})}},o=r(51),component=Object(o.a)(n,undefined,undefined,!1,null,null,null);t.default=component.exports},573:function(e,t,r){"use strict";r.r(t);var n=r(14),o=(r(56),r(21),r(372)),f=r(131),l={components:{errorHandle:o.default},data:function(){return{form:{errors:[],username:"",password:"",name:"",lastName:"",role:null,loading:!1},account:null}},computed:{isCreateAccount:function(){return"new"===this.staffId},staffId:function(){return this.$route.params.id},staffAccountName:function(){return null===this.account?"...":this.account.name+" "+this.account.lastName}},created:function(){this.isCreateAccount||this.fetchAccount()},methods:{fetchAccount:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.$axios.get("/api/staff/".concat(e.staffId));case 4:r=t.sent,data=r.data,e.$set(e,"account",data),e.form.username=e.account.username,e.form.name=e.account.name,e.form.lastName=e.account.lastName,e.form.role=e.account.role,t.next=15;break;case 13:t.prev=13,t.t0=t.catch(1);case 15:e.loading=!1;case 16:case"end":return t.stop()}}),t,null,[[1,13]])})))()},submitForm:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,e.form.errors=[],t.prev=2,t.next=5,e.$axios.post("/api/staff",{id:e.isCreateAccount?null:e.staffId,username:e.form.username,password:e.form.password,name:e.form.name,lastName:e.form.lastName,role:e.form.role});case 5:r=t.sent,r.data.success&&(f.c.fire(e.$t("popup.staff.success."+(e.isCreateAccount?"create":"edit"))),e.$router.push("/staff")),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),t.t0.response&&t.t0.response.data.error&&t.t0.response.data.error.form&&e.$set(e.form,"errors",t.t0.response.data.error.form);case 13:e.loading=!1;case 14:case"end":return t.stop()}}),t,null,[[2,10]])})))()}}},c=r(51),component=Object(c.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",[e._v("\n    "+e._s(e.$t("staff.form.title."+(e.isCreateAccount?"create":"edit"),[e.staffAccountName]))+"\n    "),r("nuxt-link",{staticClass:"btn btn-outline-dark float-right",attrs:{to:"/staff"}},[r("fa-icon",{attrs:{icon:"long-arrow-alt-left"}}),e._v(" "+e._s(e.$t("button.back"))+"\n    ")],1)],1),e._v(" "),r("b-overlay",{attrs:{show:e.form.loading}},[r("b-card",[r("b-form",{on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),e.submitForm.apply(null,arguments)}}},[r("error-handle",{attrs:{errors:e.form.errors,name:"username",prefix:"staff"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.state,o=t.invalidFeedback;return[r("b-form-group",{attrs:{state:n,"invalid-feedback":o,label:e.$t("staff.username")}},[r("b-input",{attrs:{state:n,placeholder:e.$t("staff.username"),required:""},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1)]}}])}),e._v(" "),r("error-handle",{attrs:{errors:e.form.errors,name:"password",prefix:"staff","no-valid":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.state,o=t.invalidFeedback;return[r("b-form-group",{attrs:{state:n,"invalid-feedback":o,label:e.$t("staff.password"),description:e.$t("staff.passwordDetail")}},[r("b-input",{attrs:{state:n,type:"password",placeholder:e.$t("staff.password")},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)]}}])}),e._v(" "),r("error-handle",{attrs:{errors:e.form.errors,name:"name",prefix:"staff"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.state,o=t.invalidFeedback;return[r("b-form-group",{attrs:{state:n,"invalid-feedback":o,label:e.$t("staff.name")}},[r("b-input",{attrs:{state:n,placeholder:e.$t("staff.name"),required:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)]}}])}),e._v(" "),r("error-handle",{attrs:{errors:e.form.errors,name:"lastName",prefix:"staff"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.state,o=t.invalidFeedback;return[r("b-form-group",{attrs:{state:n,"invalid-feedback":o,label:e.$t("staff.lastName")}},[r("b-input",{attrs:{state:n,placeholder:e.$t("staff.lastName"),required:""},model:{value:e.form.lastName,callback:function(t){e.$set(e.form,"lastName",t)},expression:"form.lastName"}})],1)]}}])}),e._v(" "),r("error-handle",{attrs:{errors:e.form.errors,name:"role",prefix:"staff"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.state,o=t.invalidFeedback;return[r("b-form-group",{attrs:{state:n,"invalid-feedback":o,label:e.$t("staff.role")}},[r("b-select",{attrs:{state:n,required:""},scopedSlots:e._u([{key:"first",fn:function(){return[r("b-select-option",{attrs:{value:null,disabled:""}},[e._v("\n                  "+e._s(e.$t("staff.nonRole"))+"\n                ")])]},proxy:!0}],null,!0),model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}},[e._v(" "),r("b-select-option",{attrs:{value:"physician"}},[e._v("\n                "+e._s(e.$t("staff.roles.physician"))+"\n              ")]),e._v(" "),r("b-select-option",{attrs:{value:"nurse"}},[e._v("\n                "+e._s(e.$t("staff.roles.nurse"))+"\n              ")])],1)],1)]}}])}),e._v(" "),r("b-button",{attrs:{variant:"success",type:"submit"}},[r("fa-icon",{attrs:{icon:"save"}}),e._v("\n          "+e._s(e.$t(e.isCreateAccount?"staff.create":"staff.save"))+"\n        ")],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{ErrorHandle:r(372).default})}}]);